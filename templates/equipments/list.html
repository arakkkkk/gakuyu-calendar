<!DOCTYPE html>
<html lang="en">
  {% include "layouts/_headtag.html" %}
  <body>

    <div>
      <label>貸出</label>
      <input type="date" id="start_date">
    </div>
  
    <div>
      <label>返却</label>
      <input type="date" id="end_date">
    </div>

    <button onclick="submit_form()">予約を調べる</button>

    <table class="table table-bordered" id="reservation_table">
      <thead>
        <tr>
          <th>備品名</td>
          <th></td>
          <th></td>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>jfiosida</td>
          <td>jfiosida</td>
          <td>jfiosida</td>
        </tr>
      </tbody>
    </table>

  </body>
</html>

<script>
  const check_form = () => {
      if(document.getElementById("start_date").value == ""
        || document.getElementById("end_date").value == ""
        ) {
          alert("入力を確認してください")
          return false
        }
        return true
    }

  const create_table = (reservations) =>{
    table_contents = ""
    for(let reservation of reservations) {
        table_contents += `
          <tr>
             <td>${reservation.summary}</td>
             <td>${reservation.start.dateTime}</td>
             <td>${reservation.end.dateTime}</td>
          </tr>`
    }
    document.querySelector("#reservation_table > tbody").innerHTML = table_contents
  }

  const submit_form = () => {
    //if(!check_form()) return
    const json = {
      start: document.getElementById("start_date").value,
      end: document.getElementById("end_date").value,
    }
    $.ajax({
    type: "POST",
    url: "/api/equipments/list",
    contentType: "application/json",
    data: JSON.stringify(json),
    dataType: "json",
    scriptCharset: "utf-8",
    })
    .done(function (result) {
      create_table(result)
      console.log(result)
    })
    .fail(function (data, jqXHR, textStatus, errorThrown) {
      alert("Sorry, the simulation was failed. \n Something wrong.");
    })
    .always(function () {
    });
  }
</script>

